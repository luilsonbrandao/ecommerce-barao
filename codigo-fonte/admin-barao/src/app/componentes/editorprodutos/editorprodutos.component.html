<app-navbar></app-navbar>

<div class="container mt-4 mb-5">
  <div class="row mb-4 border-bottom pb-2">
    <div class="col-12">
      <h3 class="fw-bold text-primary">
        <i class="fas fa-edit me-2"></i> {{ mode === 0 ? 'Novo Produto' : 'Editando Produto' }}
      </h3>
    </div>
  </div>

  <div class="row">
    <div class="col-md-4 mb-4">
      <div class="card shadow-sm border-0 text-center p-3">
        <label class="form-label fw-bold">Foto do Produto</label>

        <div class="mb-3">
          @if (produto.linkFoto) {
            <img [src]="produto.linkFoto" class="img-fluid rounded border p-1" style="max-height: 250px;">
          } @else {
            <div class="bg-light border rounded d-flex align-items-center justify-content-center text-muted" style="height: 200px;">
              <i class="fas fa-image fa-4x mb-2"></i><br>Sem Foto
            </div>
          }
        </div>

        <div class="input-group input-group-sm mb-2">
          <input class="form-control" type="file" (change)="selectFile($event)">
        </div>
        <button class="btn btn-primary btn-sm w-100 fw-bold" (click)="uploadFoto()" [disabled]="!arquivo || uploadEmProgresso">
          <i class="fas fa-upload me-1"></i> {{ uploadEmProgresso ? 'Enviando...' : 'Fazer Upload' }}
        </button>
      </div>
    </div>

    <div class="col-md-8">
      <div class="card shadow-sm border-0 p-4">

        <div class="mb-3">
          <label class="form-label fw-bold">Nome do Produto</label>
          <input type="text" class="form-control" [(ngModel)]="produto.nome">
        </div>

        <div class="row mb-3">
          <div class="col-md-6">
            <label class="form-label fw-bold">Categoria</label>

            @if (produto.categoria) {
              <select class="form-select" [(ngModel)]="produto.categoria!.id">
                <option value="0">Selecione uma categoria...</option>
                @for (cat of listaCategorias; track cat.id) {
                  <option [value]="cat.id">{{ cat.nome }}</option>
                }
              </select>
            }

          </div>
          <div class="col-md-6 d-flex align-items-end">
            <div class="form-check form-switch fs-5 mb-1">
              <input class="form-check-input" type="checkbox" role="switch" id="chkDisp" [(ngModel)]="disponivel">
              <label class="form-check-label fs-6 ms-2" for="chkDisp">Produto Disponível na Loja</label>
            </div>
          </div>
        </div>

        <div class="row mb-3">
          <div class="col-md-6">
            <label class="form-label fw-bold">Preço de Venda (R$)</label>
            <input type="number" class="form-control" [(ngModel)]="produto.preco">
          </div>
          <div class="col-md-6">
            <label class="form-label fw-bold">Preço Promocional (R$)</label>
            <input type="number" class="form-control" [(ngModel)]="produto.precoPromo">
          </div>
        </div>

        <div class="mb-4">
          <label class="form-label fw-bold">Detalhamento (Descrição)</label>
          <textarea class="form-control" rows="5" [(ngModel)]="produto.detalhe" placeholder="Digite a descrição detalhada do produto..."></textarea>
        </div>

        <div class="d-flex gap-2">
          <button class="btn btn-warning fw-bold text-dark px-4" (click)="salvarProduto()">
            <i class="fas fa-save me-1"></i> Salvar Dados
          </button>
          <a class="btn btn-outline-secondary px-4" routerLink='/produtos'>Voltar</a>
        </div>

      </div>
    </div>
  </div>
</div>
