<div class="container mt-5 mb-5">

  @if (!detalhePedido) {
    <div class="text-center py-5">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Carregando...</span>
      </div>
      <p class="mt-3">Buscando informações do pedido #{{idPedido}}...</p>
    </div>
  }

  @else {
    <div class="card shadow-sm border-0" id="areaImpressao">

      <div class="card-header bg-success text-white text-center py-4">
        <i class="bi bi-check-circle-fill display-4"></i>
        <h2 class="mt-2 fw-bold">Pedido Recebido!</h2>
        <p class="mb-0">Obrigado, {{ detalhePedido.cliente?.nome }}! Já estamos processando sua solicitação.</p>
      </div>

      <div class="card-body p-4">

        <div class="row text-center mb-4 border-bottom pb-4">
          <div class="col-md-6">
            <h5 class="text-muted text-uppercase small">Número do Pedido</h5>
            <h3 class="fw-bold text-dark">#{{ idPedido }}</h3>
          </div>
          <div class="col-md-6 mt-3 mt-md-0">
            <h5 class="text-muted text-uppercase small">Valor Total</h5>
            <h3 class="text-primary fw-bold">{{ detalhePedido.valorTotal | currency:'BRL' }}</h3>
          </div>
        </div>

        <div class="row mb-4">
          <div class="col-md-6">
            <h5 class="fw-bold"><i class="bi bi-truck"></i> Sobre a Entrega</h5>

            @if (detalhePedido.retirar === 1) {
              <div class="alert alert-warning">
                <strong>Retirada no Local:</strong><br>
                Você optou por retirar conosco. Aguarde nosso aviso para vir buscar seu veículo/produto na loja.
              </div>
            } @else {
              <div class="alert alert-light border">
                <strong>Entrega / Delivery:</strong><br>
                @if (detalhePedido.valorFrete > 0) {
                  O frete de <b>{{ detalhePedido.valorFrete | currency:'BRL' }}</b> já está incluso no total.
                } @else {
                  Frete a combinar ou gratuito. Entraremos em contato.
                }
              </div>
            }
          </div>

          <div class="col-md-6">
            <h5 class="fw-bold"><i class="bi bi-credit-card"></i> Pagamento & Contato</h5>
            <p>
              Entraremos em contato via WhatsApp no número
              <strong>{{ detalhePedido.cliente?.telefone }}</strong>
              para confirmar a forma de pagamento (Pix, Cartão ou Dinheiro).
            </p>
            <p class="text-muted small">
              <i class="bi bi-whatsapp text-success"></i> Nosso contato: (91) 90000-0000
            </p>
          </div>
        </div>

        <h5 class="fw-bold mb-3">Resumo dos Itens</h5>
        <div class="table-responsive">
          <table class="table align-middle">
            <thead class="table-light">
              <tr>
                <th scope="col" style="width: 80px;">Foto</th>
                <th scope="col">Produto / Serviço</th>
                <th scope="col" class="text-center">Qtd</th>
                <th scope="col" class="text-end">Subtotal</th>
              </tr>
            </thead>
            <tbody>
              @for (item of detalhePedido.itensPedido; track item.produto.id) {
                <tr>
                  <td>
                    <img [src]="item.produto.linkFoto || 'assets/sem-foto.jpg'"
                         class="img-thumbnail rounded"
                         width="60">
                  </td>
                  <td>{{ item.produto.nome }}</td>
                  <td class="text-center">{{ item.qtdeItem }}</td>
                  <td class="text-end fw-bold">
                    {{ item.precoTotal | currency:'BRL' }}
                  </td>
                </tr>
              }
            </tbody>
          </table>
        </div>

      </div> <div class="card-footer bg-light text-center py-3 d-print-none">
        <a routerLink="/" class="btn btn-outline-secondary me-2">
          <i class="bi bi-house"></i> Voltar ao Início
        </a>
        <button (click)="imprimir()" class="btn btn-primary">
          <i class="bi bi-printer"></i> Imprimir Comprovante
        </button>
      </div>

    </div>
  }
</div>
